Using OEM Mode and Respin to create a custom ISO

The following notes are regarding creating a custom install CD for an Ubuntu-based system, with as little time spent at command line as possible.

I will flesh it out into a fuller guide in time, and include a base image with extra scripts to reduce even further the need to use the command line in future.

This CD customization procedure willi eventually be aimed at non-technical persons themselves.

Tai -- 2015/03/29

======

Recommended hardware / spec for VM guest

* 1 GB RAM
* Single core CPU @ 1.8 GHz+
* 25 GB drive

Recommended hardware for host of VM

* 2 GB RAM (and nothing else running)
* dual core CPU @ 1.8 GHz
* 100 GB free space ()

1/ Download the Ubuntu ISO for the system you want to install

Start your PC or virtual machine (VM) with the ISO / CD

When prompted whether to "try" or "install" it, press F4 and choose to activate OEM Mode

Proceed through the installation as normal, choosing appropriate options. These will be applied to the end system that you will get.

2/ Restart the installed system

After the install and rebooting, you will be in "OEM mode". In this mode, you can install software and change global configurations, but the profile you will be using will not be carried over to the target install - only changes to the root account will be preserved.

To affect individual users' accounts, you will need to edit the /etc/skel setup.

Proceed to installing the software you need.

If you are using VirtualBox, you may first want to install gcc + make, install VB addons, and reboot; then uninstall gc + make.


Recommended base set of software:

	vim git zenity geany gksu gitso

* vim is a better text editor for the command line - useful for when a system admin needs to do work, especially if they are connected remotely
* git is a popular version control system which can also pull code from online repositories - again, useful should a system admin ned to do work
* zenity and gksu allow displaying dialogs from script programs - useful for putting together quick tools for fixing the system
* geany - is a programming environment, very useful for teaching programming skills. When you need to modify configuraiton files, this will be more useful than a plain text editor.
* gitso - a screen sharing tool useful to requesting help from persons at a remote computer.

Beyond these, you have the option of using the Lubuntu Software Centre, or the Synaptic Package Manager at this point (both available under Start > System Tools), or you can use a terminal and use apt-get.

As root, you can add files to the /etc/skel folder; any file in the /etc/skel folder will be copied into any subsequently newly created user. Customize user default settings through this.

Once the software is set up as you would like it, run the "Prepare for shipping to end user" link on the desktop, and reboot the computer.

If you are using a virtual machine, shut it down at this point, and take a snaptshot at this point.

3/ Boot the comptuer again. You are now out of OEM mode. You cannot retrun to it (unless you took a sapshot of your virtual machine, if applicable).

You will be prompted to create a user. This will be the user of the machine, but will not be copied over to the customization.

Once you get to the desktop you can check in your home folder that all the customizations in /etc/skel made it through to your new user.

To prep the custom ISO build, install the following packages

	dialog squashfs-tools casper ubiquity-frontend-debconf user-setup discover xresprobe

Then use dpkg to install respin from deb. You can get a copy of respin from my github:

	git clone https://github.com/taikedz/remastersys
	cd remastersys/respin-master/respin_1.2.1/

In a terminal, as root, run

	respin clean
	respin dist my-custom-distro.iso

This will build a new ISO for you

Another option is to run

	respin clean
	respin cdfs

This will creatae the directory structure for a CD, without creating the CD itself - the documentation for respin advises that this is for tweaking the image further before CD creation, but is beyond the current scoipe of our activities.

[/home/respin/respin/partimus.iso .* ready to be burned or tested in a virtual machine]

4/ Use the custom install CD to set up your other computers.

All the computers installed with this custom ISO will have the customizations you set previsouly during OEM mode. When booting from this CD, opt to immediately install. An issue with the LiveCD user creation prevents any live users from being creatred, so you can't do much with it. I'm looking into this as a post-project task.

When the target PCs have been installed and rebooted, you may want to perform some final setup tasks.

a/ Setup the standard user as an administrator. When first prompted to create a user at first reboot, this will already be the case, so call the user something like "(school name)-admin"

b/ Once logged into the desktop, create a new user "student" with a password; do NOT grant admin privileges.

